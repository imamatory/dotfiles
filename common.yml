---
- hosts: all

  vars:
    git_user: imamatory
    git_email: imamatory@gmail.com
    term: xterm-kitty

  tasks:
    - name: Install fzf
      become: yes
      shell: |
        git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf \
        && ~/.fzf/install --key-bindings --update-rc --completion \
        && cp ~/.fzf/bin/fzf /usr/local/bin
      args:
        creates: /usr/local/bin/fzf
      environment:
        TERM: "{{ term }}"

    - name: Install oh-my-zsh
      shell: |
        sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
      args:
        creates: ~/.oh-my-zsh/

    - name: Install antibody
      shell: "curl -sL git.io/antibody | sh -s"
      args:
        creates: /usr/local/bin/antibody

    - name: Setup git
      shell: |
        git config --global user.name {{ git_user }}
        git config --global user.email {{ git_email }}
        git config --global credential.helper cache

    - name: Set shell
      become: yes
      shell: "chsh {{ ansible_user }} -s $(which zsh);"
